---

- name: Nginx with configuration
  hosts: jenkins-user
  become: true
  tasks: 
   - name: Install Nginx on Ubuntu
     apt: 
      name: nginx
      state: present

   - name: Start the nginx service, if not started
     ansible.builtin.service:
      name: nginx
      state: started

   - name: Setting Up Nginx authentication
     command: "{{ item }}"
     with_items:
     - sh -c "echo -n 'dinu:' >> /etc/nginx/.htpasswd"
     - sh -c "openssl passwd -1 -salt 'AbC123' <<< 'nginx123#' >> /etc/nginx/.htpasswd"
      

  #  - name: restart nginx service
  #    ansible.builtin.service:
  #     name: nginx
  #     state: restarted


      #/var/www/html$ directory for webpage default 
      #:/etc/nginx/sites-enabled (location for auth permission allow )

  #  - name: Configure webpage for custom input
  #    ansible.builtin.replace:
  #       command: cat /dev/null > /var/www/html/index.nginx-debian.html
  #       path: /var/www/html/index.nginx-debian.html
  #       regexps: '$^'
  #       replace: <h1>hello this file in edited from ansible<h1>

  #  - name: Replace file contents with required
  #    shell:  
  #     cmd: echo "This is my new website" > /var/www/html/index.nginx-debian.html

  #  - name: restart nginx service
  #    ansible.builtin.service:
  #      name: nginx
  #      state: restarted

  #  sh -c "openssl passwd -password >> /etc/nginx/.htpasswd"
